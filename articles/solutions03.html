<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 3: Attribute operations • geocompkg | metapackage for the Gecomputation with R book</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 3: Attribute operations">
<meta property="og:description" content="geocompkg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geocompkg | metapackage for the Gecomputation with R book</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.103</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://geocompr.github.io/vignettes/">Vignettes and solutions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://geocompr.github.io/">Back to the main website</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="solutions03_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 3: Attribute operations</h1>
                        <h4 class="author">Robin Lovelace, Jakub Nowosad, Jannes Muenchow</h4>
            
            <h4 class="date">2021-08-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Robinlovelace/geocompr/blob/master/vignettes/solutions03.Rmd"><code>vignettes/solutions03.Rmd</code></a></small>
      <div class="hidden name"><code>solutions03.Rmd</code></div>

    </div>

    
    
<div id="prerequisites" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<p>The solutions assume the following packages are attached (other packages will be attached when needed):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<p>For these exercises we will use the <code>us_states</code> and <code>us_states_df</code> datasets from the <strong>spData</strong> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nowosad.github.io/spData/">spData</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">us_states</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">us_states_df</span><span class="op">)</span></code></pre></div>
<p><code>us_states</code> is a spatial object (of class <code>sf</code>), containing geometry and a few attributes (including name, region, area, and population) of states within the contiguous United States. <code>us_states_df</code> is a data frame (of class <code>data.frame</code>) containing the name and additional variables (including median income and poverty level, for years 2010 and 2015) of US states, including Alaska, Hawaii and Puerto Rico. The data comes from the US Census Bureau, and is documented in <code><a href="https://nowosad.github.io/spData/reference/us_states.html">?us_states</a></code> and <code><a href="https://nowosad.github.io/spData/reference/us_states_df.html">?us_states_df</a></code>.</p>
</div>
<div id="chapter-3" class="section level1">
<h1 class="hasAnchor">
<a href="#chapter-3" class="anchor"></a>Chapter 3</h1>
<ol style="list-style-type: decimal">
<li>Create a new object called <code>us_states_name</code> that contains only the <code>NAME</code> column from the <code>us_states</code> object. What is the class of the new object and what makes it geographic?</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states_name</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">NAME</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">us_states_name</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span></code></pre></div>
<ul>
<li>It is of class <code>sf</code> and <code>data.frame</code>: it has 2 classes.</li>
<li>It is the <code>sf</code> class that makes in geographic.</li>
<li>More specifically it is the attributes of the object (<code>sf_column</code>) and the geometry column (such as <code>bbox</code>, <code>crs</code>) that make it geographic.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">us_states_name</span><span class="op">)</span>
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "NAME"     "geometry"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $row.names</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span>
<span class="co">#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sf_column</span>
<span class="co">#&gt; [1] "geometry"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $agr</span>
<span class="co">#&gt; NAME </span>
<span class="co">#&gt; &lt;NA&gt; </span>
<span class="co">#&gt; Levels: constant aggregate identity</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">us_states_name</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span>
<span class="co">#&gt; $n_empty</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $crs</span>
<span class="co">#&gt; Coordinate Reference System:</span>
<span class="co">#&gt;   User input: EPSG:4269 </span>
<span class="co">#&gt;   wkt:</span>
<span class="co">#&gt; GEOGCS["NAD83",</span>
<span class="co">#&gt;     DATUM["North_American_Datum_1983",</span>
<span class="co">#&gt;         SPHEROID["GRS 1980",6378137,298.257222101,</span>
<span class="co">#&gt;             AUTHORITY["EPSG","7019"]],</span>
<span class="co">#&gt;         TOWGS84[0,0,0,0,0,0,0],</span>
<span class="co">#&gt;         AUTHORITY["EPSG","6269"]],</span>
<span class="co">#&gt;     PRIMEM["Greenwich",0,</span>
<span class="co">#&gt;         AUTHORITY["EPSG","8901"]],</span>
<span class="co">#&gt;     UNIT["degree",0.0174532925199433,</span>
<span class="co">#&gt;         AUTHORITY["EPSG","9122"]],</span>
<span class="co">#&gt;     AUTHORITY["EPSG","4269"]]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "sfc_MULTIPOLYGON" "sfc"             </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $precision</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bbox</span>
<span class="co">#&gt;       xmin       ymin       xmax       ymax </span>
<span class="co">#&gt; -124.70415   24.55868  -66.98240   49.38436</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Select columns from the <code>us_states</code> object which contain population data. Obtain the same result using a different command (bonus: try to find three ways of obtaining the same result). Hint: try to use helper functions, such as <code>contains</code> or <code>starts_with</code> from <strong>dplyr</strong> (see <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">?contains</a></code>).</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">total_pop_10</span>, <span class="va">total_pop_15</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 49 features and 2 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    total_pop_10 total_pop_15                       geometry</span>
<span class="co">#&gt; 1       4712651      4830620 MULTIPOLYGON (((-88.20006 3...</span>
<span class="co">#&gt; 2       6246816      6641928 MULTIPOLYGON (((-114.7196 3...</span>
<span class="co">#&gt; 3       4887061      5278906 MULTIPOLYGON (((-109.0501 4...</span>
<span class="co">#&gt; 4       3545837      3593222 MULTIPOLYGON (((-73.48731 4...</span>
<span class="co">#&gt; 5      18511620     19645772 MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 6       9468815     10006693 MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 7       1526797      1616547 MULTIPOLYGON (((-116.916 45...</span>
<span class="co">#&gt; 8       6417398      6568645 MULTIPOLYGON (((-87.52404 4...</span>
<span class="co">#&gt; 9       2809329      2892987 MULTIPOLYGON (((-102.0517 4...</span>
<span class="co">#&gt; 10      4429940      4625253 MULTIPOLYGON (((-92.01783 2...</span>

<span class="co"># or</span>
<span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"total_pop"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 49 features and 2 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    total_pop_10 total_pop_15                       geometry</span>
<span class="co">#&gt; 1       4712651      4830620 MULTIPOLYGON (((-88.20006 3...</span>
<span class="co">#&gt; 2       6246816      6641928 MULTIPOLYGON (((-114.7196 3...</span>
<span class="co">#&gt; 3       4887061      5278906 MULTIPOLYGON (((-109.0501 4...</span>
<span class="co">#&gt; 4       3545837      3593222 MULTIPOLYGON (((-73.48731 4...</span>
<span class="co">#&gt; 5      18511620     19645772 MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 6       9468815     10006693 MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 7       1526797      1616547 MULTIPOLYGON (((-116.916 45...</span>
<span class="co">#&gt; 8       6417398      6568645 MULTIPOLYGON (((-87.52404 4...</span>
<span class="co">#&gt; 9       2809329      2892987 MULTIPOLYGON (((-102.0517 4...</span>
<span class="co">#&gt; 10      4429940      4625253 MULTIPOLYGON (((-92.01783 2...</span>

<span class="co"># or</span>
<span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"total_pop"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 49 features and 2 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    total_pop_10 total_pop_15                       geometry</span>
<span class="co">#&gt; 1       4712651      4830620 MULTIPOLYGON (((-88.20006 3...</span>
<span class="co">#&gt; 2       6246816      6641928 MULTIPOLYGON (((-114.7196 3...</span>
<span class="co">#&gt; 3       4887061      5278906 MULTIPOLYGON (((-109.0501 4...</span>
<span class="co">#&gt; 4       3545837      3593222 MULTIPOLYGON (((-73.48731 4...</span>
<span class="co">#&gt; 5      18511620     19645772 MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 6       9468815     10006693 MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 7       1526797      1616547 MULTIPOLYGON (((-116.916 45...</span>
<span class="co">#&gt; 8       6417398      6568645 MULTIPOLYGON (((-87.52404 4...</span>
<span class="co">#&gt; 9       2809329      2892987 MULTIPOLYGON (((-102.0517 4...</span>
<span class="co">#&gt; 10      4429940      4625253 MULTIPOLYGON (((-92.01783 2...</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Find all states with the following characteristics (bonus find <em>and</em> plot them):
<ul>
<li>Belong to the Midwest region.</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">REGION</span> <span class="op">==</span> <span class="st">"Midwest"</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 12 features and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -104.0577 ymin: 35.99568 xmax: -80.51869 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    GEOID         NAME  REGION            AREA total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1     18      Indiana Midwest  93648.4 [km^2]      6417398      6568645</span>
<span class="co">#&gt; 2     20       Kansas Midwest 213037.1 [km^2]      2809329      2892987</span>
<span class="co">#&gt; 3     27    Minnesota Midwest 218566.5 [km^2]      5241914      5419171</span>
<span class="co">#&gt; 4     29     Missouri Midwest 180716.3 [km^2]      5922314      6045448</span>
<span class="co">#&gt; 5     38 North Dakota Midwest 183177.8 [km^2]       659858       721640</span>
<span class="co">#&gt; 6     46 South Dakota Midwest 199766.8 [km^2]       799462       843190</span>
<span class="co">#&gt; 7     17     Illinois Midwest 145993.1 [km^2]     12745359     12873761</span>
<span class="co">#&gt; 8     19         Iowa Midwest 145743.7 [km^2]      3016267      3093526</span>
<span class="co">#&gt; 9     26     Michigan Midwest 151119.0 [km^2]      9952687      9900571</span>
<span class="co">#&gt; 10    31     Nebraska Midwest 200272.3 [km^2]      1799125      1869365</span>
<span class="co">#&gt;                          geometry</span>
<span class="co">#&gt; 1  MULTIPOLYGON (((-87.52404 4...</span>
<span class="co">#&gt; 2  MULTIPOLYGON (((-102.0517 4...</span>
<span class="co">#&gt; 3  MULTIPOLYGON (((-97.22904 4...</span>
<span class="co">#&gt; 4  MULTIPOLYGON (((-95.76565 4...</span>
<span class="co">#&gt; 5  MULTIPOLYGON (((-104.0487 4...</span>
<span class="co">#&gt; 6  MULTIPOLYGON (((-104.0577 4...</span>
<span class="co">#&gt; 7  MULTIPOLYGON (((-91.41942 4...</span>
<span class="co">#&gt; 8  MULTIPOLYGON (((-96.45326 4...</span>
<span class="co">#&gt; 9  MULTIPOLYGON (((-85.63002 4...</span>
<span class="co">#&gt; 10 MULTIPOLYGON (((-104.0531 4...</span></code></pre></div>
<pre><code>- Belong to the West region, have an area below 250,000 km^2^ *and* in 2015 a population greater than 5,000,000 residents (hint: you may need to use the function `units::set_units()` or `as.numeric()`).</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">REGION</span> <span class="op">==</span> <span class="st">"West"</span>, <span class="va">AREA</span> <span class="op">&lt;</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html">set_units</a></span><span class="op">(</span><span class="fl">250000</span>, <span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,<span class="va">total_pop_15</span> <span class="op">&gt;</span> <span class="fl">5000000</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 1 feature and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt;   GEOID       NAME REGION          AREA total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1    53 Washington   West 175436 [km^2]      6561297      6985464</span>
<span class="co">#&gt;                         geometry</span>
<span class="co">#&gt; 1 MULTIPOLYGON (((-122.7699 4...</span>
<span class="co"># or</span>
<span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">REGION</span> <span class="op">==</span> <span class="st">"West"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">AREA</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">250000</span>,<span class="va">total_pop_15</span> <span class="op">&gt;</span> <span class="fl">5000000</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 1 feature and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt;   GEOID       NAME REGION          AREA total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1    53 Washington   West 175436 [km^2]      6561297      6985464</span>
<span class="co">#&gt;                         geometry</span>
<span class="co">#&gt; 1 MULTIPOLYGON (((-122.7699 4...</span></code></pre></div>
<pre><code>- Belong to the South region, had an area larger than 150,000 km^2^ or a total population in 2015 larger than 7,000,000 residents.</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">REGION</span> <span class="op">==</span> <span class="st">"South"</span>, <span class="va">AREA</span> <span class="op">&gt;</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html">set_units</a></span><span class="op">(</span><span class="fl">150000</span>, <span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="va">total_pop_15</span> <span class="op">&gt;</span> <span class="fl">7000000</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 3 features and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -106.6359 ymin: 24.55868 xmax: -80.03136 ymax: 36.50044</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt;   GEOID    NAME REGION            AREA total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1    12 Florida  South 151052.0 [km^2]     18511620     19645772</span>
<span class="co">#&gt; 2    13 Georgia  South 152725.2 [km^2]      9468815     10006693</span>
<span class="co">#&gt; 3    48   Texas  South 687714.3 [km^2]     24311891     26538614</span>
<span class="co">#&gt;                         geometry</span>
<span class="co">#&gt; 1 MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 2 MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 3 MULTIPOLYGON (((-103.0024 3...</span>
<span class="co"># or</span>
<span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">REGION</span> <span class="op">==</span> <span class="st">"South"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">AREA</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">150000</span>, <span class="va">total_pop_15</span> <span class="op">&gt;</span> <span class="fl">7000000</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 3 features and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -106.6359 ymin: 24.55868 xmax: -80.03136 ymax: 36.50044</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt;   GEOID    NAME REGION            AREA total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1    12 Florida  South 151052.0 [km^2]     18511620     19645772</span>
<span class="co">#&gt; 2    13 Georgia  South 152725.2 [km^2]      9468815     10006693</span>
<span class="co">#&gt; 3    48   Texas  South 687714.3 [km^2]     24311891     26538614</span>
<span class="co">#&gt;                         geometry</span>
<span class="co">#&gt; 1 MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 2 MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 3 MULTIPOLYGON (((-103.0024 3...</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>What was the total population in 2015 in the <code>us_states</code> dataset? What was the minimum and maximum total population in 2015?</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span>,
                        min_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span>,
                        max_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 1 feature and 3 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt;   total_pop min_pop  max_pop                       geometry</span>
<span class="co">#&gt; 1 314375347  579679 38421464 MULTIPOLYGON (((-81.68524 2...</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>How many states are there in each region?</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">REGION</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>nr_of_states <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 4 features and 2 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; # A tibble: 4 × 3</span>
<span class="co">#&gt;   REGION   nr_of_states                                                 geometry</span>
<span class="co">#&gt;   &lt;fct&gt;           &lt;int&gt;                                       &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt; 1 Norteast            9 (((-70.11867 41.24235, -70.08207 41.29909, -70.27553 41…</span>
<span class="co">#&gt; 2 Midwest            12 (((-85.48703 45.62121, -85.50127 45.75442, -85.56644 45…</span>
<span class="co">#&gt; 3 South              17 (((-81.68524 24.55868, -81.5174 24.62124, -81.40189 24.…</span>
<span class="co">#&gt; 4 West               11 (((-118.4887 33.41983, -118.4654 33.32606, -118.3102 33…</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>What was the minimum and maximum total population in 2015 in each region? What was the total population in 2015 in each region?</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">REGION</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>min_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span>,
            max_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span>,
            tot_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_pop_15</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 4 features and 4 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; # A tibble: 4 × 5</span>
<span class="co">#&gt;   REGION   min_pop  max_pop   tot_pop                                   geometry</span>
<span class="co">#&gt;   &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;                         &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt; 1 Norteast  626604 19673174  55989520 (((-70.11867 41.24235, -70.08207 41.29909…</span>
<span class="co">#&gt; 2 Midwest   721640 12873761  67546398 (((-85.48703 45.62121, -85.50127 45.75442…</span>
<span class="co">#&gt; 3 South     647484 26538614 118575377 (((-81.68524 24.55868, -81.5174 24.62124,…</span>
<span class="co">#&gt; 4 West      579679 38421464  72264052 (((-118.4887 33.41983, -118.4654 33.32606…</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Add variables from <code>us_states_df</code> to <code>us_states</code>, and create a new object called <code>us_states_stats</code>. What function did you use and why? Which variable is the key in both datasets? What is the class of the new object?</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states_stats</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">us_states_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NAME"</span> <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">us_states_stats</span><span class="op">)</span>
<span class="co">#&gt; [1] "sf"         "data.frame"</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>
<code>us_states_df</code> has two more rows than <code>us_states</code>. How can you find them? (hint: try to use the <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">dplyr::anti_join()</a></code> function)</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">us_states</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"state"</span> <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 5</span>
<span class="co">#&gt;   state  median_income_10 median_income_15 poverty_level_10 poverty_level_15</span>
<span class="co">#&gt;   &lt;chr&gt;             &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Alaska            29509            31455            64245            72957</span>
<span class="co">#&gt; 2 Hawaii            29945            31051           124627           153944</span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>What was the population density in 2015 in each state? What was the population density in 2010 in each state?</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states2</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pop_dens_15 <span class="op">=</span> <span class="va">total_pop_15</span><span class="op">/</span><span class="va">AREA</span>,
         pop_dens_10 <span class="op">=</span> <span class="va">total_pop_10</span><span class="op">/</span><span class="va">AREA</span><span class="op">)</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>How much has population density changed between 2010 and 2015 in each state? Calculate the change in percentages and map them.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_popdens_change</span> <span class="op">=</span> <span class="va">us_states2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pop_dens_diff_10_15 <span class="op">=</span> <span class="va">pop_dens_15</span> <span class="op">-</span> <span class="va">pop_dens_10</span>,
         pop_dens_diff_10_15p <span class="op">=</span> <span class="op">(</span><span class="va">pop_dens_diff_10_15</span><span class="op">/</span><span class="va">pop_dens_15</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">us_popdens_change</span><span class="op">[</span><span class="st">"pop_dens_diff_10_15p"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="solutions03_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<ol start="11" style="list-style-type: decimal">
<li>Change the columns names in <code>us_states</code> to lowercase. (Hint: helper functions - <code><a href="https://rdrr.io/r/base/chartr.html">tolower()</a></code> and <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code> may help).</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 49 features and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436</span>
<span class="co">#&gt; Geodetic CRS:  NAD83</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    geoid        name   region             area total_pop_10 total_pop_15</span>
<span class="co">#&gt; 1     01     Alabama    South 133709.27 [km^2]      4712651      4830620</span>
<span class="co">#&gt; 2     04     Arizona     West 295281.25 [km^2]      6246816      6641928</span>
<span class="co">#&gt; 3     08    Colorado     West 269573.06 [km^2]      4887061      5278906</span>
<span class="co">#&gt; 4     09 Connecticut Norteast  12976.59 [km^2]      3545837      3593222</span>
<span class="co">#&gt; 5     12     Florida    South 151052.01 [km^2]     18511620     19645772</span>
<span class="co">#&gt; 6     13     Georgia    South 152725.21 [km^2]      9468815     10006693</span>
<span class="co">#&gt; 7     16       Idaho     West 216512.66 [km^2]      1526797      1616547</span>
<span class="co">#&gt; 8     18     Indiana  Midwest  93648.40 [km^2]      6417398      6568645</span>
<span class="co">#&gt; 9     20      Kansas  Midwest 213037.08 [km^2]      2809329      2892987</span>
<span class="co">#&gt; 10    22   Louisiana    South 122345.76 [km^2]      4429940      4625253</span>
<span class="co">#&gt;                          geometry</span>
<span class="co">#&gt; 1  MULTIPOLYGON (((-88.20006 3...</span>
<span class="co">#&gt; 2  MULTIPOLYGON (((-114.7196 3...</span>
<span class="co">#&gt; 3  MULTIPOLYGON (((-109.0501 4...</span>
<span class="co">#&gt; 4  MULTIPOLYGON (((-73.48731 4...</span>
<span class="co">#&gt; 5  MULTIPOLYGON (((-81.81169 2...</span>
<span class="co">#&gt; 6  MULTIPOLYGON (((-85.60516 3...</span>
<span class="co">#&gt; 7  MULTIPOLYGON (((-116.916 45...</span>
<span class="co">#&gt; 8  MULTIPOLYGON (((-87.52404 4...</span>
<span class="co">#&gt; 9  MULTIPOLYGON (((-102.0517 4...</span>
<span class="co">#&gt; 10 MULTIPOLYGON (((-92.01783 2...</span></code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Using <code>us_states</code> and <code>us_states_df</code> create a new object called <code>us_states_sel</code>. The new object should have only two variables - <code>median_income_15</code> and <code>geometry</code>. Change the name of the <code>median_income_15</code> column to <code>Income</code>.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_states_sel</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">us_states_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NAME"</span> <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>Income <span class="op">=</span> <span class="va">median_income_15</span><span class="op">)</span></code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li>Calculate the change in the number of residents living below the poverty level between 2010 and 2015 for each state. (Hint: See ?us_states_df for documentation on the poverty level columns.) Bonus: Calculate the change in the <em>percentage</em> of residents living below the poverty level in each state.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_pov_change</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">us_states_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NAME"</span> <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pov_change <span class="op">=</span> <span class="va">poverty_level_15</span> <span class="op">-</span> <span class="va">poverty_level_10</span><span class="op">)</span>
 
<span class="co"># Bonus</span>
<span class="va">us_pov_pct_change</span> <span class="op">=</span> <span class="va">us_states</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">us_states_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NAME"</span> <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pov_pct_10 <span class="op">=</span> <span class="op">(</span><span class="va">poverty_level_10</span> <span class="op">/</span> <span class="va">total_pop_10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, pov_pct_15 <span class="op">=</span> <span class="op">(</span><span class="va">poverty_level_15</span> <span class="op">/</span> <span class="va">total_pop_15</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pov_pct_change <span class="op">=</span> <span class="va">pov_pct_15</span> <span class="op">-</span> <span class="va">pov_pct_10</span><span class="op">)</span></code></pre></div>
<ol start="14" style="list-style-type: decimal">
<li>What was the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region? Bonus: What is the region with the largest increase in people living below the poverty line?</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">us_pov_change_reg</span> <span class="op">=</span> <span class="va">us_pov_change</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">REGION</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>min_state_pov_15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">poverty_level_15</span><span class="op">)</span>,
            mean_state_pov_15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">poverty_level_15</span><span class="op">)</span>,
            max_state_pov_15 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">poverty_level_15</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Bonus</span>
<span class="va">us_pov_change</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">REGION</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>region_pov_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pov_change</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region_pov_change</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">region_pov_change</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">REGION</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.character.html">as.character</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "South"</span></code></pre></div>
<ol start="15" style="list-style-type: decimal">
<li>Create a raster from scratch with nine rows and columns and a resolution of 0.5 decimal degrees (WGS84). Fill it with random numbers. Extract the values of the four corner cells.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">9</span>, ncol <span class="op">=</span> <span class="fl">9</span>, res <span class="op">=</span> <span class="fl">0.5</span>, xmn <span class="op">=</span> <span class="fl">0</span>, xmx <span class="op">=</span> <span class="fl">4.5</span>,
           ymn <span class="op">=</span> <span class="fl">0</span>, ymx <span class="op">=</span> <span class="fl">4.5</span>, vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">)</span><span class="op">)</span>
<span class="co"># using cell IDs</span>
<span class="va">r</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">81</span> <span class="op">-</span> <span class="fl">9</span>, <span class="fl">81</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1]  0.1385180  2.5144048  0.4936865 -0.3759739</span>
<span class="co"># using indexing</span>
<span class="va">r</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">ncol</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1]  0.1385180  2.5144048  0.4802633 -0.3759739</span>
<span class="co"># corresponds to [1, 1], [1, 9], [9, 1], [9, 9]</span></code></pre></div>
<ol start="16" style="list-style-type: decimal">
<li>What is the most common class of our example raster <code>grain</code> (hint: <code><a href="https://rdrr.io/pkg/raster/man/modal.html">modal()</a></code>)?</li>
</ol>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grain_size</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"clay"</span>, <span class="st">"silt"</span>, <span class="st">"sand"</span><span class="op">)</span>
<span class="va">grain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">6</span>, res <span class="op">=</span> <span class="fl">0.5</span>, 
               xmn <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, xmx <span class="op">=</span> <span class="fl">1.5</span>, ymn <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, ymx <span class="op">=</span> <span class="fl">1.5</span>,
               vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">grain_size</span>, <span class="fl">36</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
                             levels <span class="op">=</span> <span class="va">grain_size</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/cellStats.html">cellStats</a></span><span class="op">(</span><span class="va">grain</span>, <span class="va">modal</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">factorValues</a></span><span class="op">(</span><span class="va">grain</span>, <span class="va">.</span><span class="op">)</span>
<span class="co">#&gt;   VALUE</span>
<span class="co">#&gt; 1  clay</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">factorValues</a></span><span class="op">(</span><span class="va">grain</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/modal.html">modal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/getValues.html">values</a></span><span class="op">(</span><span class="va">grain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   VALUE</span>
<span class="co">#&gt; 1  clay</span></code></pre></div>
<ol start="17" style="list-style-type: decimal">
<li>Plot the histogram and the boxplot of the <code><a href="https://rdrr.io/r/utils/data.html">data(dem, package = "spDataLarge")</a></code> raster.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">dem</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/hist.html">hist</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></code></pre></div>
<p><img src="solutions03_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<ol start="18" style="list-style-type: decimal">
<li>Now attach also <code><a href="https://rdrr.io/r/utils/data.html">data(ndvi, package = "spDataLarge")</a></code>. Create a raster stack using <code>dem</code> and <code>ndvi</code>, and make a <code><a href="https://rdrr.io/pkg/raster/man/pairs.html">pairs()</a></code> plot.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ndvi</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span>
<span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html">stack</a></span><span class="op">(</span><span class="va">dem</span>, <span class="va">ndvi</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/pairs.html">pairs</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></code></pre></div>
<p><img src="solutions03_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Jakub Nowosad, Jannes Muenchow.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
