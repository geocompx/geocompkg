<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2: Geographic data in R • geocompkg | metapackage for the Gecomputation with R book</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Geographic data in R">
<meta property="og:description" content="geocompkg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geocompkg | metapackage for the Gecomputation with R book</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://geocompr.github.io/vignettes/">Vignettes and solutions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://geocompr.github.io/">Back to the main website</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="solutions02_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 2: Geographic data in R</h1>
                        <h4 class="author">Robin Lovelace, Jakub Nowosad, Jannes Muenchow</h4>
            
            <h4 class="date">2021-09-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Robinlovelace/geocompr/blob/master/vignettes/solutions02.Rmd"><code>vignettes/solutions02.Rmd</code></a></small>
      <div class="hidden name"><code>solutions02.Rmd</code></div>

    </div>

    
    
<div id="prerequisites" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<p>The solutions assume the following packages are attached (other packages will be attached when needed):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nowosad.github.io/spData/">spData</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="chapter-2" class="section level1">
<h1 class="hasAnchor">
<a href="#chapter-2" class="anchor"></a>Chapter 2</h1>
<!-- ## Vector data model -->
<ol style="list-style-type: decimal">
<li>Use <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> on the geometry column of the <code>world</code> data object. What does the output tell us about:
<ul>
<li>Its geometry type?</li>
<li>The number of countries?</li>
<li>Its coordinate reference system (CRS)?</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  MULTIPOLYGON     epsg:4326 +proj=long... </span>
<span class="co">#&gt;           177             0             0</span></code></pre></div>
<ul>
<li>The geometry type: <code>MULTIPOLYGON</code>, there are 177 countries and the coordinate reference system (CRS) is WGS84 (EPSG 4326)</li>
</ul>
</li>
<li>Run the code that ‘generated’ the map of the world in this <a href="https://geocompr.robinlovelace.net/spatial-class.html#fig:contpop">Figure</a> at the end of this <a href="https://geocompr.robinlovelace.net/spatial-class.html#base-args">section</a>. Find two similarities and two differences between the image on your computer and that in the book.
<ul>
<li>What does the <code>cex</code> argument do (see <code><a href="https://r-spatial.github.io/sf/reference/plot.html">?plot</a></code>)?</li>
<li>Why was <code>cex</code> set to the <code>sqrt(world$pop) / 10000</code>?</li>
<li>Bonus: experiment with different ways to visualize the global population.</li>
</ul>
</li>
</ol>
<p>The version generated by the code and the version in the book are shown in the left and right figures, respectively:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">old_par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># save graphical parameters</span>

<span class="co"># generate version based on code in the book</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span><span class="op">[</span><span class="st">"continent"</span><span class="op">]</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">cex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">world</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10000</span>
<span class="va">world_cents</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">world</span>, of_largest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">world_cents</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, cex <span class="op">=</span> <span class="va">cex</span>, reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># generate version in the book from online script:</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old_par</span><span class="op">)</span>
<span class="va">s</span> <span class="op">=</span> <span class="st">"https://github.com/Robinlovelace/geocompr/raw/main/code/02-contpop.R"</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></code></pre></div>
<p><img src="solutions02_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="solutions02_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<p>Similarities: global extent, colorscheme, size of circles</p>
<p>Differences: projection (Antarctica is much smaller for example), graticules, location of points in the countries.</p>
<p>To understand these differences read-over, run, and experiment with different argument values in this script: <a href="https://github.com/Robinlovelace/geocompr/raw/main/code/02-contpop.R" class="uri">https://github.com/Robinlovelace/geocompr/raw/main/code/02-contpop.R</a></p>
<p><code>cex</code> refers to the diameter of symbols plotted, as explained by the help page <code><a href="https://rdrr.io/r/graphics/points.html">?graphics::points</a></code>. It is an acronym for ‘Chacter symbol EXpansion’. It was set to the square route of the population divided by 10,000 because a) otherwise the symbols would not fit on the map and b) to make circle area proportional to population.</p>
<ol start="3" style="list-style-type: decimal">
<li>Use <code><a href="https://r-spatial.github.io/sf/reference/plot.html">plot()</a></code> to create maps of Nigeria in context (see section <a href="https://geocompr.robinlovelace.net/spatial-class.html#basic-map" class="uri">https://geocompr.robinlovelace.net/spatial-class.html#basic-map</a>).
<ul>
<li>Adjust the <code>lwd</code>, <code>col</code> and <code>expandBB</code> arguments of <code><a href="https://r-spatial.github.io/sf/reference/plot.html">plot()</a></code>.</li>
<li>Challenge: read the documentation of <code><a href="https://rdrr.io/pkg/raster/man/text.html">text()</a></code> and annotate the map. <!-- - Bonus: make the country boundaries a dotted gray line. --> <!-- - Hint: `border` is an additional argument of `plot()` for **sf**  objects. -->
</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nigeria</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">name_long</span> <span class="op">==</span> <span class="st">"Nigeria"</span>, <span class="op">]</span>
<span class="va">africa</span> <span class="op">=</span> <span class="va">world</span><span class="op">[</span><span class="va">world</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Africa"</span>, <span class="op">]</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, main <span class="op">=</span> <span class="st">"Nigeria in context"</span>, border <span class="op">=</span> <span class="st">"lightgrey"</span>, expandBB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">nigeria</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"yellow"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span>
<span class="va">a</span> <span class="op">=</span> <span class="va">africa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Niger"</span>, <span class="va">africa</span><span class="op">$</span><span class="va">name_long</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">ncentre</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="va">ncentre_num</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">ncentre</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ncentre_num</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">ncentre_num</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, labels <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">name_long</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="solutions02_files/figure-html/nigeria-1.png" alt="Map of Nigeria in context illustrating sf's plotting capabilities" width="700"><p class="caption">
Map of Nigeria in context illustrating sf’s plotting capabilities
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Create an empty <code>RasterLayer</code> object called <code>my_raster</code> with 10 columns and 10 rows.</li>
</ol>
<p>Assign random values between 0 and 10 to the new raster and plot it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">-</span><span class="fl">09</span><span class="op">-</span><span class="fl">03</span><span class="op">)</span>
<span class="va">my_raster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">10</span>, nrow <span class="op">=</span> <span class="fl">10</span>, vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">my_raster</span><span class="op">)</span></code></pre></div>
<p><img src="solutions02_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<!-- raster exercises -->
<ol start="5" style="list-style-type: decimal">
<li>Read the <code>raster/nlcd2011.tif</code> file from the <strong>spDataLarge</strong> package. What kind of information can you get about the properties of this file?</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nlcd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"raster/nlcd2011.tif"</span>, package <span class="op">=</span> <span class="st">"spDataLarge"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in showSRID(SRS_string, format = "PROJ", multiline = "NO", prefer_proj =</span>
<span class="co">#&gt; prefer_proj): Discarded datum unknown in Proj4 definition</span>
<span class="va">nlcd</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 1359, 1073, 1458207  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 31.5303, 31.52466  (x, y)</span>
<span class="co">#&gt; extent     : 301903.3, 335735.4, 4111244, 4154086  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=utm +zone=12 +ellps=GRS80 +units=m +no_defs </span>
<span class="co">#&gt; source     : nlcd2011.tif </span>
<span class="co">#&gt; names      : nlcd2011 </span>
<span class="co">#&gt; values     : 11, 95  (min, max)</span></code></pre></div>
<p>You can get information about:</p>
<ul>
<li>dimensions - a number of rows (<code>nrow</code>), a number of columns (<code>ncol</code>), a total number of cells (<code>ncell</code>)</li>
<li>resolution - x and y resolution in the map units</li>
<li>spatial extent of the dataset - <code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>
</li>
<li>coordinate reference system</li>
<li>range of values - <code>min</code> and <code>max</code>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Jakub Nowosad, Jannes Muenchow.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
